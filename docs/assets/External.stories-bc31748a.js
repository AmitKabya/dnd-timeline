import{K as Y,u as Re,f as Se,i as ve,j as Te,k as Ee,l as Le,n as Ne,C as le,o as Oe,p as ke,q as qe,r as ue,s as Me,e as Ve,g as me,a as re,t as ze,h as P,m as J,T as Ae,b as Fe,D as je,I as He,c as Be,d as Pe}from"./utils-8cb0c50b.js";import{j as y,a as $}from"./jsx-runtime-91a467a5.js";import{r as o,R as be}from"./index-8db94870.js";import"./_commonjsHelpers-042e6b4d.js";import"./index-8ce4a492.js";function de(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function $e(e,t){return e.reduce((n,r,l)=>{const d=t.get(r);return d&&(n[l]=d),n},Array(e.length))}function Q(e){return e!==null&&e>=0}function We(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ke(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Ie=e=>{let{rects:t,activeIndex:n,overIndex:r,index:l}=e;const d=de(t,r,n),i=t[l],c=d[l];return!c||!i?null:{x:c.left-i.left,y:c.top-i.top,scaleX:c.width/i.width,scaleY:c.height/i.height}},ye="Sortable",xe=be.createContext({activeIndex:-1,containerId:ye,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Ie,disabled:{draggable:!1,droppable:!1}});function Ue(e){let{children:t,id:n,items:r,strategy:l=Ie,disabled:d=!1}=e;const{active:i,dragOverlay:c,droppableRects:s,over:u,measureDroppableContainers:a}=Re(),I=Se(ye,n),_=c.rect!==null,g=o.useMemo(()=>r.map(C=>typeof C=="object"&&"id"in C?C.id:C),[r]),q=i!=null,N=i?g.indexOf(i.id):-1,x=u?g.indexOf(u.id):-1,M=o.useRef(g),R=!We(g,M.current),S=x!==-1&&N===-1||R,v=Ke(d);ve(()=>{R&&q&&a(g)},[R,g,q,a]),o.useEffect(()=>{M.current=g},[g]);const T=o.useMemo(()=>({activeIndex:N,containerId:I,disabled:v,disableTransforms:S,items:g,overIndex:x,useDragOverlay:_,sortedRects:$e(g,s),strategy:l}),[N,I,v.draggable,v.droppable,S,g,x,s,_,l]);return be.createElement(xe.Provider,{value:T},t)}const Xe=e=>{let{id:t,items:n,activeIndex:r,overIndex:l}=e;return de(n,r,l).indexOf(t)},Ge=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:l,items:d,newIndex:i,previousItems:c,previousContainerId:s,transition:u}=e;return!u||!r||c!==d&&l===i?!1:n?!0:i!==l&&t===s},Ye={duration:200,easing:"ease"},he="transform",Je=le.Transition.toString({property:he,duration:0,easing:"linear"}),Qe={roleDescription:"sortable"};function Ze(e){let{disabled:t,index:n,node:r,rect:l}=e;const[d,i]=o.useState(null),c=o.useRef(n);return ve(()=>{if(!t&&n!==c.current&&r.current){const s=l.current;if(s){const u=Oe(r.current,{ignoreTransform:!0}),a={x:s.left-u.left,y:s.top-u.top,scaleX:s.width/u.width,scaleY:s.height/u.height};(a.x||a.y)&&i(a)}}n!==c.current&&(c.current=n)},[t,n,r,l]),o.useEffect(()=>{d&&i(null)},[d]),d}function et(e){let{animateLayoutChanges:t=Ge,attributes:n,disabled:r,data:l,getNewIndex:d=Xe,id:i,strategy:c,resizeObserverConfig:s,transition:u=Ye}=e;const{items:a,containerId:I,activeIndex:_,disabled:g,disableTransforms:q,sortedRects:N,overIndex:x,useDragOverlay:M,strategy:R}=o.useContext(xe),S=tt(r,g),v=a.indexOf(i),T=o.useMemo(()=>({sortable:{containerId:I,index:v,items:a},...l}),[I,l,v,a]),C=o.useMemo(()=>a.slice(a.indexOf(i)),[a,i]),{rect:A,node:F,isOver:W,setNodeRef:f}=Te({id:i,data:T,disabled:S.droppable,resizeObserverConfig:{updateMeasurementsFor:C,...s}}),{active:p,activatorEvent:D,activeNodeRect:E,attributes:O,setNodeRef:k,listeners:V,isDragging:z,over:K,setActivatorNodeRef:U,transform:X}=Ee({id:i,data:T,attributes:{...Qe,...n},disabled:S.draggable}),G=Le(f,k),w=!!p,j=w&&!q&&Q(_)&&Q(x),H=!M&&z,B=H&&j?X:null,h=j?B??(c??R)({rects:N,activeNodeRect:E,activeIndex:_,overIndex:x,index:v}):null,b=Q(_)&&Q(x)?d({id:i,items:a,activeIndex:_,overIndex:x}):v,L=p==null?void 0:p.id,m=o.useRef({activeId:L,items:a,newIndex:b,containerId:I}),Ce=a!==m.current.items,ce=t({active:p,containerId:I,isDragging:z,isSorting:w,id:i,index:v,items:a,newIndex:m.current.newIndex,previousItems:m.current.items,previousContainerId:m.current.containerId,transition:u,wasDragging:m.current.activeId!=null}),ne=Ze({disabled:!ce,index:v,node:F,rect:A});return o.useEffect(()=>{w&&m.current.newIndex!==b&&(m.current.newIndex=b),I!==m.current.containerId&&(m.current.containerId=I),a!==m.current.items&&(m.current.items=a)},[w,b,I,a]),o.useEffect(()=>{if(L===m.current.activeId)return;if(L&&!m.current.activeId){m.current.activeId=L;return}const we=setTimeout(()=>{m.current.activeId=L},50);return()=>clearTimeout(we)},[L]),{active:p,activeIndex:_,attributes:O,data:T,rect:A,index:v,newIndex:b,items:a,isOver:W,isSorting:w,isDragging:z,listeners:V,node:F,overIndex:x,over:K,setNodeRef:G,setActivatorNodeRef:U,setDroppableNodeRef:f,setDraggableNodeRef:k,transform:ne??h,transition:De()};function De(){if(ne||Ce&&m.current.newIndex===v)return Je;if(!(H&&!Ne(D)||!u)&&(w||ce))return le.Transition.toString({...u,property:he})}}function tt(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}Y.Down,Y.Right,Y.Up,Y.Left;const nt="_container_1v9y7_1",rt={container:nt},at="_list_11bgf_1",it="_item_11bgf_11",ee={list:at,item:it,"item-dragging":"_item-dragging_11bgf_28","item-overlay":"_item-overlay_11bgf_32","item-background":"_item-background_11bgf_36"},st={"list-container":"_list-container_1ekq2_1"};function ae(e){const{getRelevanceFromDragEvent:t,millisecondsToPixels:n}=ke(),{attributes:r,isDragging:l,listeners:d,setNodeRef:i,transform:c,transition:s}=et({id:e.id,disabled:e.disabled,data:{type:"list-item",duration:e.duration,getRelevanceFromDragEvent:t}}),a={width:l?n(e.duration)+"px":"",opacity:l?.4:void 0,transform:le.Translate.toString(c),transition:s};return y("li",{className:st["item-wrapper"],ref:i,style:a,...d,...r,...d,children:e.children})}try{ae.displayName="ExternalListItem",ae.__docgenInfo={description:"",displayName:"ExternalListItem",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},background:{defaultValue:null,description:"",name:"background",required:!1,type:{name:"boolean"}},duration:{defaultValue:null,description:"",name:"duration",required:!0,type:{name:"number"}}}}}catch{}const _e=y("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:y("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"})});function ie({relevance:e}){return $("div",{className:qe(ee.item,ee["item-overlay"]),children:[_e,$("span",{children:[ue(e.start,"HH:mm")," - ",ue(e.end,"HH:mm")]})]})}function se({listItems:e}){return y(Ue,{items:e,children:y("ul",{className:ee.list,children:e.map(t=>y(ae,{id:t.id,disabled:t.disabled,duration:t.duration,children:$("div",{className:ee.item,children:[_e,y("span",{children:t.disabled?"Disabled Item":"List Item"})]})},t.id))})})}try{ie.displayName="ListItemOverlay",ie.__docgenInfo={description:"",displayName:"ListItemOverlay",props:{relevance:{defaultValue:null,description:"",name:"relevance",required:!0,type:{name:"Relevance"}}}}}catch{}try{se.displayName="ExternalList",se.__docgenInfo={description:"",displayName:"ExternalList",props:{listItems:{defaultValue:null,description:"",name:"listItems",required:!0,type:{name:"ListItemDefinition[]"}}}}}catch{}const ot={start:Me(new Date),end:Ve(new Date)};function oe(e){var R,S,v,T,C,A,F,W;const[t,n]=o.useState(e.timeframe||ot),[r]=o.useState(()=>[...me(e.rowCount),...me(e.disabledRowCount||0,{disabled:!0})]),[l,d]=o.useState(()=>[...re(e.itemCount,t,r),...re(e.disabledItemCount||0,t,r,{disabled:!0}),...re(e.backgroundItemCount||0,t,r,{background:!0})]),[i,c]=o.useState(()=>[...ze(e.listItemCount)]),[s,u]=o.useState(null),[a,I]=o.useState(null),_=o.useCallback(f=>u(f.active),[u]),g=o.useCallback(()=>u(null),[u]),q=o.useCallback(f=>{var z,K,U,X,G,w,j,H,B,te;const p=(z=f.over)==null?void 0:z.id.toString();if(!p)return;const D=f.active.id,E=(X=(U=(K=f.over)==null?void 0:K.data)==null?void 0:U.current)==null?void 0:X.type,O=(j=(w=(G=f.active)==null?void 0:G.data)==null?void 0:w.current)==null?void 0:j.type,V=((te=(B=(H=f.active)==null?void 0:H.data)==null?void 0:B.current)==null?void 0:te.getRelevanceFromDragEvent)(f);V&&E==="timeline-row"&&O==="timeline-item"?d(h=>h.map(b=>b.id!==D?b:{...b,rowId:p,relevance:V})):D!==p&&E==="list-item"&&O==="list-item"?c(h=>{const b=h.findIndex(({id:m})=>m===D),L=h.findIndex(({id:m})=>m===p);return de(h,b,L)}):V&&E==="timeline-row"&&O==="list-item"&&(c(h=>h.filter(b=>b.id!==D)),d(h=>{const b={id:D.toString(),rowId:p.toString(),relevance:V};return[...h,b]})),u(null)},[d,c,u]),N=o.useCallback(f=>{var p;return I((p=f.active.data.current)==null?void 0:p.getRelevanceFromDragEvent(f))},[]),x=o.useCallback(f=>{var E;const p=(E=f.active.data.current)==null?void 0:E.relevance;if(!p)return;const D=f.active.id;d(O=>O.map(k=>k.id!==D?k:{...k,relevance:p}))},[d]),M=o.useMemo(()=>[{value:P(1)},{value:J(30),maxTimeframeSize:P(24)},{value:J(15),maxTimeframeSize:P(12)},{value:J(5),maxTimeframeSize:P(6)},{value:J(1),maxTimeframeSize:P(2)}],[]);return y("div",{className:rt.container,children:$(Ae,{onDragEnd:q,onDragMove:N,onResizeEnd:x,onDragStart:_,onDragCancel:g,timeframe:t,onTimeframeChanged:n,timeframeGridSize:M,children:[y(se,{listItems:i}),y(Fe,{rows:r,items:l}),$(je,{...((S=(R=s==null?void 0:s.data)==null?void 0:R.current)==null?void 0:S.width)&&{style:{width:((T=(v=s==null?void 0:s.data)==null?void 0:v.current)==null?void 0:T.width)+"px"}},children:[((A=(C=s==null?void 0:s.data)==null?void 0:C.current)==null?void 0:A.type)==="timeline-item"&&a&&y(He,{relevance:a}),((W=(F=s==null?void 0:s.data)==null?void 0:F.current)==null?void 0:W.type)==="list-item"&&a&&y(ie,{relevance:a})]})]})})}try{oe.displayName="ExternalListWrapper",oe.__docgenInfo={description:"",displayName:"ExternalListWrapper",props:{rowCount:{defaultValue:null,description:"",name:"rowCount",required:!0,type:{name:"number"}},itemCount:{defaultValue:null,description:"",name:"itemCount",required:!0,type:{name:"number"}},listItemCount:{defaultValue:null,description:"",name:"listItemCount",required:!0,type:{name:"number"}},timeframe:{defaultValue:null,description:"",name:"timeframe",required:!1,type:{name:"Relevance"}},disabledItemCount:{defaultValue:null,description:"",name:"disabledItemCount",required:!1,type:{name:"number"}},disabledRowCount:{defaultValue:null,description:"",name:"disabledRowCount",required:!1,type:{name:"number"}},backgroundItemCount:{defaultValue:null,description:"",name:"backgroundItemCount",required:!1,type:{name:"number"}},generateDroppableMap:{defaultValue:null,description:"",name:"generateDroppableMap",required:!1,type:{name:"boolean"}}}}}catch{}Be({locale:Pe});const ft={title:"External",component:oe},Z={args:{itemCount:5,listItemCount:5,rowCount:5}};var fe,pe,ge;Z.parameters={...Z.parameters,docs:{...(fe=Z.parameters)==null?void 0:fe.docs,source:{originalSource:`{
  args: {
    itemCount: 5,
    listItemCount: 5,
    rowCount: 5
  }
}`,...(ge=(pe=Z.parameters)==null?void 0:pe.docs)==null?void 0:ge.source}}};const pt=["Basic"];export{Z as Basic,pt as __namedExportsOrder,ft as default};
//# sourceMappingURL=External.stories-bc31748a.js.map
